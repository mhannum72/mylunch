<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Places Test</title>
        <link rel="stylesheet" href="/css/reset.css" />
        <link rel="stylesheet" href="/css/960.css" />
        <link rel="stylesheet" href="/css/text.css" />
        <link rel="stylesheet" href="/css/mealdisp.css" />
        <link rel="stylesheet" href="/css/autosuggest.css" />
    </head>

    <body>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&sensor=true"></script>
    <script type="text/javascript" src="autosuggest.js"></script>
    <style>
    </style>

    <script type="text/javascript">

        function AutoProvider() {
            this.autoserv = new google.maps.places.AutocompleteService();
        }

        AutoProvider.prototype.requestSuggestions = function (oAutoSuggestControl) {
            var enorth = new google.maps.LatLng(40.876449, -73.325071);            

            var arequest = {
                input: oAutoSuggestControl.userText,
                location: enorth,
                radius: 3000,
                types: ['establishment']
            };

            this.autoserv.getPlacePredictions(arequest, function(predictions, status) {
                if(status != google.maps.places.PlacesServiceStatus.OK) {
                    console.log('got weird status from getPlacePredictions: ' + status);
                    return;
                }

                oAutoSuggestControl.autosuggest(predictions);

            });
        }

        function initialize() {

            var textbox = document.getElementById('autotest');
            var autoProv = new AutoProvider();
            var autoControl = new AutoSuggestControl(textbox, autoProv);

        }

        google.maps.event.addDomListener(window, 'load', initialize);

    </script>

    <div id='autodiv'>
        <input type="text" name="autotest" id="autotest" autocomplete="off" size="80">
    </div>

    </body>
</html>
